@using AppView.Components.Models
@typeparam TModel

<EditForm Model="Model" OnValidSubmit="OnValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
    @if (Fields != null && Fields.Count > 0)
    {
        @foreach (var field in Fields)
        {
            <div class="mb-2">
                <label>@field.Label</label>
                @if (field.Template != null)
                {
                    @field.Template(Model)
                }
                else
                {
                    <InputText class="form-control" value="@field.ValueGetter(Model)"
                        @oninput="e => field.ValueSetter?.Invoke(Model, e.Value?.ToString() ?? string.Empty)" />
                }
            </div>
        }
    }
    <button class="btn btn-primary" type="submit">LÆ°u</button>
</EditForm>

@code {
    [Parameter] public TModel Model { get; set; } = default!;
    [Parameter] public List<FormFieldConfig<TModel>> Fields { get; set; } = new();
    [Parameter] public EventCallback OnValidSubmit { get; set; }
}